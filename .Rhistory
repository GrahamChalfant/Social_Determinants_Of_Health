library(tidyverse)
library(stringr)
library(lubridate)
library(stringr)
library(lubridate)
data <- read_csv("HospitalCosts.csv")
head(data)
str(data)
data$FEMALE <- as.factor(data$FEMALE)
#Check data is in correct form
str(data)
summary(data)
data$RACE <- as.factor(data$RACE)
summary(data)
summary(data)
na.omit(data)
data <- na.omit(data)
summary(data)#There is one NA in RACE - will remove column
data <- read_csv("HospitalCosts.csv")
row_number(data)
length(row_number(data))
#FEMALE needs to be catagorical
data$FEMALE <- as.factor(data$FEMALE)
data$RACE <- as.factor(data$RACE)
summary(data)#There is one NA in RACE - will remove column
length(row_number(data))
length(row_number(data))
summary(data)#There is one NA in RACE - will remove column
data <- na.omit(data)
length(row_number(data))
#Check data is in correct form
str(data)
data <- read_csv("HospitalCosts.csv")
head(data)
data <- read_csv("HospitalCosts.csv")
data
count(data)
data <- na.omit(data)
count(data)
hist(data$AGE)
table(data$FEMALE)
hist(data$RACE)
hist(data$TOTCHG)
table(data$)
table(data$APRDRG)
hist(data$APRDRG)
count(data$APRDRG)
length(data$APRDRG)
hist(data$APRDRG)
data %>% arrange(desc(APRDRG)
data %>% arrange(desc(APRDRG))
data %>% arrange(desc(APRDRG))
data %>% group_by(APRDRG) %>% count(APRDRG) %>%  arrange(desc(APRDRG))
data %>% group_by(APRDRG) %>% count(APRDRG) %>% arrange(desc(n))
hist(data$LOS)
boxplot(data$LOS)
hist(data$TOTCHG)
boxplot(data$RACE) #Race is predominantly 1
boxplot(data$TOTCHG)
data %>% group_by(age) %>% summarise(avg_stay = mean(LOS))
data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS))
data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay))
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay))
average_stay_data
ggplot(average_stay_data, aes(x = age, y = avg_stay)) + geom_bar()
ggplot(average_stay_data, aes(x = AGE, y = avg_stay)) + geom_bar()
ggplot(average_stay_data, aes(x = AGE, y = avg_stay)) + geom_bar(stat = "identity")
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, color = AGE)) + geom_bar(stat = "identity")
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = AGE)) + geom_bar(stat = "identity")
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity")
average_stay_data
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity")
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = MAX(TOTCHG), avg_exp = mean(TOTCHG))
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = max(TOTCHG), avg_exp = mean(TOTCHG))
max_exp
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = max(TOTCHG), avg_exp = mean(TOTCHG)) %>% arrange(desc(max_exp))
max_exp
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
average_stay_data
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay)) %>% mutate(AGE2 = fct_reorder(AGE, avg_stay))
average_stay_data
average_stay_data <- average_stay_data %>% mutate(AGE2 = fct_reorder(AGE, avg_stay))
ggplot(average_stay_data, aes(x = AGE, y = forcats::fct_infreq(avg_stay), fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
average_stay_data$avg_stay <- factor(average_stay_data$avg_stay,                                    # Factor levels in decreasing order
levels = average_stay_data$avg_stay[order(average_stay_data$avg_stay, decreasing = TRUE)])
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay)) %>% mutate(AGE2 = fct_reorder(AGE, avg_stay))
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay)) %>% mutate(AGE2 = fct_reorder(AGE, avg_stay))
library(tidyverse)
library(stringr)
library(lubridate)
#https://www.kaggle.com/ravichaubey1506/healthcare-cost#
data <- read_csv("HospitalCosts.csv")
head(data)
#Check data is in correct form
str(data)
#FEMALE needs to be catagorical
data$FEMALE <- as.factor(data$FEMALE)
data$RACE <- as.factor(data$RACE)
summary(data)#There is one NA in RACE - will remove column
count(data)
data <- na.omit(data) #removed the row with a NA race
count(data)
hist(data$AGE)#mostly younger individuals
table(data$FEMALE) #Even split of male and female - more females than males
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
hist(data$RACE) #Race is predominantly 1
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay)) %>% mutate(AGE2 = fct_reorder(AGE, avg_stay))
average_stay_data
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay)) %>% mutate(AGE2 = fct_reorder(AGE, avg_stay))
library(tidyverse)
library(stringr)
library(lubridate)
#https://www.kaggle.com/ravichaubey1506/healthcare-cost#
data <- read_csv("HospitalCosts.csv")
head(data)
#Check data is in correct form
str(data)
#FEMALE needs to be catagorical
data$FEMALE <- as.factor(data$FEMALE)
data$RACE <- as.factor(data$RACE)
summary(data)#There is one NA in RACE - will remove column
count(data)
data <- na.omit(data) #removed the row with a NA race
count(data)
hist(data$AGE)#mostly younger individuals
table(data$FEMALE) #Even split of male and female - more females than males
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
hist(data$RACE) #Race is predominantly 1
hist(data$RACE) #Race is predominantly 1
table(data$RACE) #Race is predominantly 1
hist(data$RACE) #Race is predominantly 1
table(data$RACE) #Race is predominantly 1
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay)) %>% mutate(AGE2 = fct_reorder(AGE, avg_stay))
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
average_stay_data[order(avg_stay)]
average_stay_data
average_stay_data[avg_stay]
average_stay_data$avg_stay <- as.factor(average_stay_data$avg_stay)
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
library(tidyverse)
library(stringr)
library(lubridate)
#https://www.kaggle.com/ravichaubey1506/healthcare-cost#
data <- read_csv("HospitalCosts.csv")
head(data)
#Check data is in correct form
str(data)
#FEMALE needs to be catagorical
data$FEMALE <- as.factor(data$FEMALE)
data$RACE <- as.factor(data$RACE)
summary(data)#There is one NA in RACE - will remove column
count(data)
data <- na.omit(data) #removed the row with a NA race
count(data)
hist(data$AGE)#mostly younger individuals
table(data$FEMALE) #Even split of male and female - more females than males
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
table(data$RACE) #Race is predominantly 1
boxplot(data$TOTCHG)#Potential outliers
data %>% group_by(APRDRG) %>% count(APRDRG) %>% arrange(desc(n)) #APRDRG 640 is by far the most frequent diagnosis group
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
library(tidyverse)
library(stringr)
library(lubridate)
#https://www.kaggle.com/ravichaubey1506/healthcare-cost#
data <- read_csv("HospitalCosts.csv")
head(data)
#Check data is in correct form
str(data)
#FEMALE needs to be catagorical
data$FEMALE <- as.factor(data$FEMALE)
data$RACE <- as.factor(data$RACE)
summary(data)#There is one NA in RACE - will remove column
count(data)
data <- na.omit(data) #removed the row with a NA race
count(data)
hist(data$AGE)#mostly younger individuals
table(data$FEMALE) #Even split of male and female - more females than males
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
table(data$RACE) #Race is predominantly 1
boxplot(data$TOTCHG)#Potential outliers
data %>% group_by(APRDRG) %>% count(APRDRG) %>% arrange(desc(n)) #APRDRG 640 is by far the most frequent diagnosis group
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
#Max discharge and average discharge by age
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = max(TOTCHG), avg_exp = mean(TOTCHG)) %>% arrange(desc(max_exp))
average_stay_data$AGE <- factor(average_stay_data$AGE, levels = average_stay_data$AGE[order(average_stay_data$avg_stay)])
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + scale_x_continuous(breaks=seq(0,17,1))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") #+ scale_x_continuous(breaks=seq(0,17,1))
boxplot(data$TOTCHG)#Potential outliers
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
data <- data %>% filter(LOS >= 10000)
count(data)
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
library(tidyverse)
library(stringr)
library(lubridate)
#https://www.kaggle.com/ravichaubey1506/healthcare-cost#
data <- read_csv("HospitalCosts.csv")
head(data)
#Check data is in correct form
str(data)
#FEMALE needs to be catagorical
data$FEMALE <- as.factor(data$FEMALE)
data$RACE <- as.factor(data$RACE)
summary(data)#There is one NA in RACE - will remove column
count(data)
data <- na.omit(data) #removed the row with a NA race
count(data)
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
data <- data %>% filter(LOS <= 10)
count(data)
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay))
average_stay_data$AGE <- factor(average_stay_data$AGE, levels = average_stay_data$AGE[order(average_stay_data$avg_stay)])
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") #+ scale_x_continuous(breaks=seq(0,17,1))
#Max discharge and average discharge by age
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = max(TOTCHG), avg_exp = mean(TOTCHG)) %>% arrange(desc(max_exp))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + coord_flip() #+ scale_x_continuous(breaks=seq(0,17,1))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + coord_flip() + labs(title = "Average stay by age" #+ scale_x_continuous(breaks=seq(0,17,1))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + coord_flip() + labs(title = "Average stay by age") #+ scale_x_continuous(breaks=seq(0,17,1))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + coord_flip() + labs(title = "Average stay by age") #+ scale_x_continuous(breaks=seq(0,17,1))
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + coord_flip() + labs(title = "Average stay by age", x = "Age", y = "Average length of stay") #+ scale_x_continuous(breaks=seq(0,17,1))
#Max discharge and average discharge by age
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = max(TOTCHG), avg_exp = mean(TOTCHG)) %>% arrange(desc(max_exp))
max_exp
ggplot(max_exp, aes(x = AGE, y = max_exp)) + geom_bar(stat = "identity")
boxplot(data$TOTCHG)#Potential outliers
stat(boxplot(data$TOTCHG))#There is deffinitely an outlier
stat(boxplot(data$TOTCHG))#There is deffinitely an outlier
boxplot(stat(data$TOTCHG))#There is deffinitely an outlier
boxplot(stat(data$TOTCHG))#There is deffinitely an outlier
boxplot.stats(data$TOTCHG)#There is deffinitely an outlier
boxplot(data$TOTCHG)
boxplot.stats(data$TOTCHG)#There is deffinitely an outlier
stats_TOTCHG <- boxplot.stats(data$TOTCHG)#There is deffinitely an outlier
stat_TOTCHG$out
stats_TOTCHG <- boxplot.stats(data$TOTCHG)#There is deffinitely an outlier
stats_TOTCHG
stats_TOTCHG$out
stats_TOTCHG$out %>% arrange(desc(out))
stats_TOTCHG
stats_TOTCHG %>% arrange(desc(out))
TOTCHG_out <- as.data.frame(stats_TOTCHG$out) %>% arrange(desc(out))
TOTCHG_out <- as.data.frame(stats_TOTCHG$out)
TOTCHG_out
stats_df <- data.frame(matrix(unlist(stats_TOTCHG, ncol = 3, brow = TRUE)))
stats_df <- data.frame(matrix(unlist(stats_TOTCHG)))
stats_df
TOTCHG_out <- stats_TOTCHG$out %>% arrange(desc(stats_TOTCHG$out))
TOTCHG_out <- stats_TOTCHG$out
TOTCHG_out
TOTCHG_out <- as.data.frame(stats_TOTCHG$out)
TOTCHG_out
TOTCHG_out <- as.data.frame(stats_TOTCHG$out) %>% arrange(desc(stats_TOTCHG$out))
TOTCHG_out
as.data.frame(stats_TOTCHG$out) %>% arrange(desc(stats_TOTCHG$out))
hist(as.data.frame(stats_TOTCHG$out) %>% arrange(desc(stats_TOTCHG$out)))
hist(as.data.frame(as.numeric(stats_TOTCHG$out)) %>% arrange(desc(stats_TOTCHG$out)))
as.data.frame(stats_TOTCHG$out) %>% arrange(desc(stats_TOTCHG$out))
boxplot(data$TOTCHG)
data <- data %>% filter(TOTCHG <= 40000)
boxplot(data$TOTCHG)
library(tidyverse)
library(stringr)
library(lubridate)
#https://www.kaggle.com/ravichaubey1506/healthcare-cost#
data <- read_csv("HospitalCosts.csv")
head(data)
#Check data is in correct form
str(data)
#FEMALE needs to be catagorical
data$FEMALE <- as.factor(data$FEMALE)
data$RACE <- as.factor(data$RACE)
summary(data)#There is one NA in RACE - will remove column
count(data)
data <- na.omit(data) #removed the row with a NA race
count(data)
hist(data$AGE)#mostly younger individuals
table(data$FEMALE) #Even split of male and female - more females than males
boxplot(data$LOS)#Could be potential outliers in length of stay - will determine after modeling
data <- data %>% filter(LOS <= 10)
count(data) #removed 10 rows
table(data$RACE) #Race is predominantly 1
boxplot(data$TOTCHG)
data <- data %>% filter(TOTCHG <= 40000)
data %>% group_by(APRDRG) %>% count(APRDRG) %>% arrange(desc(n)) #APRDRG 640 is by far the most frequent diagnosis group
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay))
average_stay_data$AGE <- factor(average_stay_data$AGE, levels = average_stay_data$AGE[order(average_stay_data$avg_stay)])
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + coord_flip() + labs(title = "Average stay by age", x = "Age", y = "Average length of stay") #+ scale_x_continuous(breaks=seq(0,17,1))
#Max discharge and average discharge by age
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = max(TOTCHG), avg_exp = mean(TOTCHG)) %>% arrange(desc(max_exp))
ggplot(max_exp, aes(x = AGE, y = max_exp)) + geom_bar(stat = "identity")
max_exp
?pivot_longer
max_exp
max_exp_longer <- pivot_longer(data, AGE)
max_exp_longer
max_exp_longer <- pivot_longer(max_exp, AGE)
max_exp_longer
max_exp_longer <- pivot_longer(max_exp, avg_exp)
max_exp_longer
max_exp
max_exp_longer <- pivot_longer(max_exp, c(avg_exp, max_exp))
max_exp_longer
ggplot(max_exp_longer, aes(x = AGE, y = value, fill = factor(name))) + geom_bar(stat = "identity")
ggplot(max_exp_longer, aes(x = AGE, y = value, fill = factor(name))) + geom_bar(stat = "identity", position = "dodge")
ggplot(max_exp_longer, aes(x = AGE, y = value, fill = factor(name))) + geom_bar(stat = "identity", position = "dodge")+
scale_fill_discrete(name="Expenditure",
breaks=c(1, 2),
labels=c("Average", "Max"))
ggplot(max_exp_longer, aes(x = AGE, y = value, fill = factor(name))) + geom_bar(stat = "identity", position = "dodge")+
scale_fill_discrete(name="Expenditure",
labels=c("Average", "Max"))
ggplot(max_exp_longer, aes(x = AGE, y = value, fill = factor(name))) + geom_bar(stat = "identity", position = "dodge")+
scale_fill_discrete(name="Expenditure",
labels=c("Average", "Max")) +
labs(title = "Expenditure by age", x = "Age", y = "Expense")
max_exp_longer$AGE <- factor(max_exp_longer$AGE, levels = max_exp_longer$AGE[order(max_exp_longer$value)])
max_exp_longer
max_exp
ggplot(max_exp_longer, aes(x = AGE, y = value, fill = factor(name))) + geom_bar(stat = "identity", position = "dodge")+
scale_fill_discrete(name="Expenditure",
labels=c("Average", "Max")) +
labs(title = "Expenditure by age", x = "Age", y = "Expense")
#Average stay by age
average_stay_data <- data %>% group_by(AGE) %>% summarise(avg_stay = mean(LOS)) %>% arrange(desc(avg_stay))
average_stay_data$AGE <- factor(average_stay_data$AGE, levels = average_stay_data$AGE[order(average_stay_data$avg_stay)])
ggplot(average_stay_data, aes(x = AGE, y = avg_stay, fill = avg_stay)) + geom_bar(stat = "identity") + coord_flip() + labs(title = "Average stay by age", x = "Age", y = "Average length of stay") #+ scale_x_continuous(breaks=seq(0,17,1))
#Max discharge and average discharge by age
max_exp <- data %>% group_by(AGE) %>% summarise(max_exp = max(TOTCHG), avg_exp = mean(TOTCHG)) %>% arrange(desc(max_exp))
max_exp_longer <- pivot_longer(max_exp, c(avg_exp, max_exp))
ggplot(max_exp_longer, aes(x = AGE, y = value, fill = factor(name))) + geom_bar(stat = "identity", position = "dodge")+
scale_fill_discrete(name="Expenditure",
labels=c("Average", "Max")) +
labs(title = "Expenditure by age", x = "Age", y = "Expense")
